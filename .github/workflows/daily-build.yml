name: Daily build testing
env: 
  DEV_DATE: ${{github.event.client_payload.dev-date}} 

on:
  repository_dispatch:
    types: [ daily-build ]

jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        guide: [ guide-getting-started, guide-cdi-intro ]
    steps:
      - run: echo Test Build - ${{github.event.client_payload.dev-date}}
      - name: Set up JDK 1.8
        uses: actions/setup-java@v1
        with:
          java-version: 1.8
      - run: unset _JAVA_OPTIONS
      - name: Clone ${{ matrix.guide }} repository
        uses: actions/checkout@v2
        with:
          repository: OpenLiberty/${{ matrix.guide }}
          path: ${{ matrix.guide }}
          ref: refs/heads/master
      - name: Test ${{ matrix.guide }}
        run: |
             echo ${{github.event.client_payload.dev-date}}
             cd ${{ matrix.guide }}/finish
             pwd
             chmod +x ../scripts/travisTest.sh
             #../scripts/travisTest.sh
